document.addEventListener("DOMContentLoaded",()=>{let e=null,t=null,n=document.createElement("div");n.innerHTML=`<div class="modal fade" id="linkModal" tabindex="-1"><div class="modal-dialog modal-sm modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h5 class="modal-title">Insert Link</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button></div><div class="modal-body"><input type="url" id="linkInput" class="form-control" placeholder="https://example.com"></div><div class="modal-footer"><button type="button" id="saveLink" class="btn btn-primary">Insert</button></div></div></div></div>`,document.body.appendChild(n);let i;document.querySelectorAll("textarea.html-it").forEach(n=>{n.style.display="none";let l=document.createElement("div");l.classList.add("editor-wrapper");let s=document.createElement("div");s.classList.add("editor-toolbar","d-flex","gap-2","align-items-center","flex-wrap");let d=document.createElement("div");d.classList.add("editor-content"),d.contentEditable="true",d.innerHTML=n.value,e=d;let a=!1,c=l=>{let s=document.createElement("button");return s.innerHTML=l.icon,s.type="button",s.classList.add("btn","btn-sm","btn-white"),s.onclick=()=>{if(l.isHtmlToggle)(a=!a)?(d.textContent=d.innerHTML,d.contentEditable="false",d.classList.add("code-view")):(d.innerHTML=d.textContent,d.contentEditable="true",d.classList.remove("code-view"));else if("createLink"===l.cmd){e=d;let s=window.getSelection();s.rangeCount>0&&(t=s.getRangeAt(0)),(i=new bootstrap.Modal(document.getElementById("linkModal"))).show()}else document.execCommand(l.cmd,!1,null),n.value=d.innerHTML},s},o={undoRedo:[{cmd:"undo",icon:"<img src='https://cdn.jsdelivr.net/gh/micoma-nl/html-it/dist/icons/back.svg' class='icon'>"},{cmd:"redo",icon:"<img src='https://cdn.jsdelivr.net/gh/micoma-nl/html-it/dist/icons/forward.svg' class='icon'>"},],formatting:[{cmd:"bold",icon:"<img src='https://cdn.jsdelivr.net/gh/micoma-nl/html-it/dist/icons/bold.svg' class='icon'>"},{cmd:"italic",icon:"<img src='https://cdn.jsdelivr.net/gh/micoma-nl/html-it/dist/icons/italic.svg' class='icon'>"},{cmd:"underline",icon:"<img src='https://cdn.jsdelivr.net/gh/micoma-nl/html-it/dist/icons/underline.svg' class='icon'>"},],lists:[{cmd:"insertUnorderedList",icon:"<img src='https://cdn.jsdelivr.net/gh/micoma-nl/html-it/dist/icons/list-ul.svg' class='icon'>"},{cmd:"insertOrderedList",icon:"<img src='https://cdn.jsdelivr.net/gh/micoma-nl/html-it/dist/icons/list-ol.svg' class='icon'>"},],alignment:[{cmd:"justifyLeft",icon:"<img src='https://cdn.jsdelivr.net/gh/micoma-nl/html-it/dist/icons/text-left.svg' class='icon'>"},{cmd:"justifyCenter",icon:"<img src='https://cdn.jsdelivr.net/gh/micoma-nl/html-it/dist/icons/text-center.svg' class='icon'>"},{cmd:"justifyRight",icon:"<img src='https://cdn.jsdelivr.net/gh/micoma-nl/html-it/dist/icons/text-right.svg' class='icon'>"},],misc:[{cmd:"createLink",icon:"<img src='https://cdn.jsdelivr.net/gh/micoma-nl/html-it/dist/icons/link.svg' class='icon'>"},{cmd:"code",icon:"<img src='https://cdn.jsdelivr.net/gh/micoma-nl/html-it/dist/icons/code-slash.svg' class='icon'>",isHtmlToggle:!0},]};Object.values(o).forEach(e=>{let t=document.createElement("div");t.classList.add("btn-group"),e.forEach(e=>t.appendChild(c(e))),s.appendChild(t)});let r=document.createElement("div");r.classList.add("dropdown");let m=document.createElement("button");m.classList.add("btn","btn-sm","btn-white","dropdown-toggle"),m.setAttribute("data-bs-toggle","dropdown"),m.innerHTML="<img src='https://cdn.jsdelivr.net/gh/micoma-nl/html-it/dist/icons/card-heading.svg' class='icon'> Heading";let g=document.createElement("div");g.classList.add("dropdown-menu"),["H1","H2","H3","H4","H5","H6","P"].forEach(e=>{let t=document.createElement("button");t.type="button",t.classList.add("dropdown-item"),t.innerHTML=`<${e.toLowerCase()}>${"P"===e?"Paragraph":"Heading "+e.slice(1)}</${e.toLowerCase()}>`,t.onclick=()=>{let t=window.getSelection();if(t.rangeCount>0){let i=t.getRangeAt(0),l=i.startContainer;for(;l&&1!==l.nodeType;)l=l.parentNode;if(l&&/^h[1-6]|p$/i.test(l.tagName)){let s=document.createElement(e.toLowerCase());s.innerHTML=l.innerHTML,l.parentNode.replaceChild(s,l)}else document.execCommand("formatBlock",!1,e.toLowerCase());n.value=d.innerHTML}},g.appendChild(t)}),r.appendChild(m),r.appendChild(g),s.appendChild(r);let h=document.createElement("select");h.classList.add("form-select","form-select-sm","w-auto"),["Arial","Georgia","Times New Roman","Courier New","Verdana"].forEach(e=>{let t=document.createElement("option");t.value=e,t.textContent=e,t.style.fontFamily=e,h.appendChild(t)}),h.onchange=e=>{document.execCommand("fontName",!1,e.target.value),n.value=d.innerHTML},s.appendChild(h),d.addEventListener("input",()=>{n.value=d.innerHTML}),l.appendChild(s),l.appendChild(d),n.parentNode.insertBefore(l,n.nextSibling)}),document.addEventListener("click",n=>{if("saveLink"===n.target.id){let l=document.getElementById("linkInput").value;if(l&&e&&t){let s=window.getSelection();s.removeAllRanges(),s.addRange(t),document.execCommand("createLink",!1,l),e.dispatchEvent(new Event("input"))}i.hide(),document.getElementById("linkInput").value=""}})});
